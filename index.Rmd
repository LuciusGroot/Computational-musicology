---
title: "portfolio"
author: "Lucius Groot"
date: "2024-02-21"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: cosmo
    

---


### Introduction

Dear Reader,

For this project, I want to analyse different versions of the musical piece: 4'33'' by John Cage. 4'33'' is a piece made by John Cage. It is not my favourite song, but it questions perfectly what music is and what it can be. I am interested in which information I can get about the different versions, by analysing it with Rstudios. That is why I made 4 playlists with different versions of 4'33''. The first playlist contains all the 57 versions I could find on Spotify, some of them are just parts of the pieces. The 2nd playlist are all the version made and played/performed by John Cage. The 3rd playlist are the versions that do not give credits to John Cage, but has the same or a similar name. The 4th playlist consist of interpretation of 4'33''.


The lists that I use are these list:
Playlist 1: https://open.spotify.com/playlist/34a7macvtzIMePk2fRq4oC?si=78984ccde61a4f44 
Playlist 2: https://open.spotify.com/playlist/5sWJTo3Zxy9oTf5CCqc624?si=2db9da0f122a49ae
Playlist 3: https://open.spotify.com/playlist/7qwMKRYgTiRLOLszqDYyj9?si=76be1e131ac94e7d
Playlist 4:https://open.spotify.com/playlist/383bBCxqKWd8tpvWrU9yYH?si=ae28a61a0874436b

These are the libraries that I use:
library(tidyverse)
library(spotifyr)
library(compmus)

I hope that I have informed you well enough and enjoy reading my analysis of 4'33"'s.

Kind regards, Lucius Groot

```{r}
library(tidyverse)
library(spotifyr)
library(compmus)

#All (4'33'') I could find.
aic <- get_playlist_audio_features("", "34a7macvtzIMePk2fRq4oC") 

 #Made and performed by John Cage
map <- get_playlist_audio_features("", "5sWJTo3Zxy9oTf5CCqc624") 
       
 #Covers/Interpretation of 4'33'' who did not credit John Cage
ciwc <- get_playlist_audio_features("", "7qwMKRYgTiRLOLszqDYyj9") 

 #Made but not performed by John Cage
mnp <- get_playlist_audio_features("", "383bBCxqKWd8tpvWrU9yYH") 

 #10 versions with the same length
t10 <- get_playlist_audio_features("", "7uZC9eTFcWrVxQIHhy45IE") 

 

#shortcut for the 4 playlists 
sc <-
  bind_rows(
    map |> mutate(category = "Made and performed"),
    ciwc |> mutate(category = "Covers/Interpretation without credits to John Cage"),
    mnp |> mutate(category = "Made but not performed by John Cage")
  )
```

### week 9

```{r}

```



### week 8
```{r}
##map track 1
map1 <-
  get_tidy_audio_analysis("2bNCdW4rLnCTzgqUXTTDO1") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

##map track 2
map2 <-
  get_tidy_audio_analysis("5B7HHrAsopOgp3wjP0PMgT") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

##map track 3
map3 <-
  get_tidy_audio_analysis("4F76YbFSTzXboAKhyypE7a") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)


compmus_long_distance(
  map1 |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  map2 |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  feature = pitches,
  method = "euclidean"
) |>
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "map track 1", y = "map track 2") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

compmus_long_distance(
  map1 |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  map3 |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  feature = pitches,
  method = "euclidean"
) |>
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "map track 2", y = "map track 3") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

compmus_long_distance(
  map2 |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  map3 |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  feature = pitches,
  method = "euclidean"
) |>
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "map track 2", y = "map track 3") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

map1 |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()

map2 |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()

map3 |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()


```


***
I do not know what I can conclude from the map tracks; but apparently every 4'33'' has its own key; while I cannot hear a key if I am listening.



### week 7
In week 7, I experiment with different codes. You can see what my results are in the following tabs:

### Summary of the lists

```{r}
#summary of "All I could find"
aic |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  ) 

#summary of  "Made and performed"
map |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )

#summary of  "cover/interpration without credits"
ciwc |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )

#summary of  "Made not performed"
mnp |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )

#summary of  "10 versions of the same length"
t10 |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )


#summary of  "10 versions"
sc |>
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )


```

***
The summary I let Rstudio made of my lists:
It is possible to make a summary of 4'33'', but not if there are too many songs in one playlist. 


  


### Valence/Energy/Mode

I want to know of both the lists:
Valence versus energy + the mode

```{r}
 

 
#The three lists combined
ggplot(aic, aes(valence, energy)) +
  geom_point(aes(colour= mode)) +
  scale_y_log10() +
   ggtitle("All I could find")

 
  #The plot of the different versions made and performed by John Cage
ggplot(map, aes(valence, energy)) +
  geom_point(aes(colour= mode)) +
  scale_y_log10() +
   ggtitle("Made and performed")

  #Plot of different covers
ggplot(ciwc, aes(valence, energy)) +
  geom_point(aes(colour= mode)) +
  scale_y_log10() +
   ggtitle("Covers/Interpretation without credits")

#Plot of version made but not played by John Cage
ggplot(mnp, aes(valence, energy)) +
  geom_point(aes(colour= mode)) +
  scale_y_log10() +
   ggtitle("Made but not played")

#Plot of the 10 version's 
ggplot(t10, aes(valence, energy)) +
  geom_point(aes(colour= mode)) +
  scale_y_log10() +
   ggtitle("Plot of 10 versions of the same length")

```

***
I will have to reconsider the setting of the plots.


### Valence/Energy/Mode in a smoothcurve


```{r}

  #the plots combined
sc |> ggplot(aes(x = valence, y = energy)) + geom_point() + geom_smooth() + 
  facet_wrap(~category) + 
  ggtitle("All I could find")
 
  #all I could find
aic |> ggplot(aes(x = valence, y = energy, color = mode)) + 
  geom_point() + 
  geom_smooth(span = 0.5) +  #idk what this does
  ggtitle("All I could find")

  #Made and performed
map |> ggplot(aes(x = valence, y = energy, color = mode)) + 
  geom_point() + 
  geom_smooth(span = 0.5) +  #idk what this does
  ggtitle("Made and performed")

  #Cover/Interpretation without credits
ciwc |> ggplot(aes(x = valence, y = energy)) + geom_point() + geom_smooth() +
    ggtitle("Cover/Interpretation without credits")

  #Made but not performed by John Cage
mnp |> ggplot(aes(x = valence, y = energy)) + geom_point() + geom_smooth() +
    ggtitle("Made but not performed")

#the plots individual: 10 versions
t10 |> ggplot(aes(x = valence, y = energy)) + geom_point() + geom_smooth() +
    ggtitle("10 versions")



```

*** 
I want to know of both the lists:
How can there be a key? What makes that there are different energies and how can some be negative?



### The code of the homework week 7

```{r}

#making 4 plots next to each other
sc |>                    # Start with shortcut of all the playlists
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) |>
  ggplot(                     #This is the code I used for making the plot with ggplot2, i took inspiration from the assignment during the class
    aes(
      x = valence,
      y = energy,
      size = loudness,
      colour = mode
    )
  ) +
  geom_point() +              #first I tried to make a scatterplot
  geom_rug(linewidth = 0.1) + #deciding that the border is x
  geom_text(                  #valence versus energy labels
    aes(
      x = valence,
      y = energy,
      label = label
    ),
    data = 
      tibble(
        label = c("??", "??"),
        category = c("??", "??"),
        valence = c(0.104, 0.0339),
        energy = c(0.992, 0.00166)
      ),
    colour = "black",         #colour of the plot is black
    size = 4,                 ##i want the size of the plot to be 4
    hjust = "left",           #i was making left side
    vjust = "center",         #i was making right side
    nudge_x = 0.02            #i wanted to place the label slightly to the right
  ) +
  facet_wrap(~ category) +    #i decided that i wanted to use both my playlist in two plots in one, again
  scale_x_continuous(         #i decided to fine-tune the x axis
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),  #i used grid-lines for quadrants only.
    minor_breaks = NULL       #i wanted to remove 'minor' grid-lines.
  ) +
  scale_y_continuous(        #i fine-tuned the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(       #the color brewer i used for making a was palette
    type = "qual",            #i have a qualitative set
    palette = "Paired"        #i named the palette to 'Paired'
  ) +
  scale_size_continuous(      #i decided to also fine-tune the sizes of each point
    trans = "exp",            #i used an exp transformation to emphasise loud
    guide = "none"            #i remove the legend for size, did not need it
  ) +
  theme_light() +             #making the theme light
  labs(                       #Deciding the title
    x = "Valence",
    y = "Energy",
    colour = "Mode"
  )

```
***

I took some inspiration of the homework for my longest code ever



### Histogram of the lists


The histogram I made about both the lists:


  
```{r}
#histogram of everything i could find
sc |>
  ggplot(aes(x = energy)) +
  geom_histogram(binwidth = 0.005) +
  facet_wrap(~category) + ggtitle("4'33''")

aic |>
  ggplot(aes(x = energy)) +
  geom_histogram(binwidth = 0.005) + ggtitle("all i could find")

map |>
  ggplot(aes(x = energy)) +
  geom_histogram(binwidth = 0.005) + ggtitle("4'33''")

ciwc |>
  ggplot(aes(x = energy)) +
  geom_histogram(binwidth = 0.005) + ggtitle("4'33''")

mnp |>
  ggplot(aes(x = energy)) +
  geom_histogram(binwidth = 0.005) + ggtitle("4'33''")

t10 |>
  ggplot(aes(x = energy)) +
  geom_histogram(binwidth = 0.005) + ggtitle("4'33''")
```

***
nothing special


### conclusion